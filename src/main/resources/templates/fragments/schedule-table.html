<!-- schedule table fragment -->
<th:block th:fragment="scheduleTable(weekDays)">
    <div class="table-responsive">
        <table class="table table-bordered align-middle text-center">
            <thead class="table-secondary fw-semibold">
            <tr>
                <th class="fw-semibold">Role \ Day</th>
                <th class="fw-semibold"
                    th:each="d : ${weekDays}"
                    th:text="${#temporals.dayOfWeekName(d)} + ' ' + ${#temporals.format(d, 'MM/dd')}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''">
                </th>
            </tr>
            </thead>
            <tbody>

            <!-- Lunch section header -->
            <tr class="table-light">
                <th class="text-start fw-bold" colspan="8">Lunch</th>
            </tr>

            <!-- Lunch: Server -->
            <tr>
                <th class="text-start fw-semibold">Server</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'LUNCH_LUNCH_SERVER'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null and !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''"
                    >
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Lunch: Assistant -->
            <tr>
                <th class="text-start fw-semibold">Assistant</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'LUNCH_LUNCH_ASSISTANT'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Lunch: Manager -->
            <tr>
                <th class="text-start fw-semibold">Manager</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'LUNCH_LUNCH_MANAGER'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${asg.employee.username == #authentication.name} ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner section header -->
            <tr class="table-light">
                <th class="text-start fw-bold" colspan="8">Dinner</th>
            </tr>

            <!-- Dinner: Server 1 -->
            <tr>
                <th class="text-start fw-semibold">Server 1</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_SERVER_1'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Server 2 -->
            <tr>
                <th class="text-start fw-semibold">Server 2</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_SERVER_2'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Server 3 (commented out) -->
            <!--/*
            <tr>
                <th class="text-start fw-semibold">Server 3</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_SERVER_3'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${asg.employee.username == #authentication.name} ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>
            */-->

            <!-- Dinner: Sushi -->
            <tr>
                <th class="text-start fw-semibold">Sushi</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_SUSHI'},
                             asg=${assignmentsGrid != null and assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Grey divider between Server/Sushi and the rest of the dinner roles -->
            <tr class="table-light">
                <th class="table-borderless"></th>
                <th colspan="7"><br></th>
            </tr>

            <!-- Dinner: Expo -->
            <tr>
                <th class="text-start fw-semibold">Expo</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_EXPO'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Busser 1 -->
            <tr>
                <th class="text-start fw-semibold">Busser 1</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_BUSSER_1'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Busser 2 -->
            <tr>
                <th class="text-start fw-semibold">Busser 2</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_BUSSER_2'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Host 1 -->
            <tr>
                <th class="text-start fw-semibold">Host 1</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_HOST_1'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: Host 2 -->
            <tr>
                <th class="text-start fw-semibold">Host 2</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_HOST_2'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            <!-- Dinner: FLOAT -->
            <tr>
                <th class="text-start fw-semibold">FLOAT</th>
                <td th:each="d : ${weekDays}"
                    th:classappend="${#temporals.dayOfWeek(d) == 1 or #temporals.dayOfWeek(d) == 7} ? ' bg-closed' : ''"
                    th:with="dk=${#temporals.format(d,'yyyy-MM-dd')},
                             rk=${'DINNER_FLOAT'},
                             asg=${assignmentsGrid != null && assignmentsGrid.containsKey(dk) ? assignmentsGrid.get(dk).get(rk) : null}">
                    <span th:if="${asg != null}"
                          class="fw-semibold"
                          th:text="${asg.employee.fullName != null && !#strings.isEmpty(asg.employee.fullName) ? asg.employee.fullName : asg.employee.username}"
                          th:classappend="${
                          highlightCurrentUser != null and highlightCurrentUser
                          and asg.employee.username == #authentication.name
                          } ? ' schedule-name-current' : ''">
                        —
                    </span>
                    <span th:unless="${asg != null}">—</span>
                </td>
            </tr>

            </tbody>
        </table>
    </div>
</th:block>
